[{"content":"One would think working in IT would make me a patient person. Today I found myself tired of waiting for the ConnectWise Automate agents to be deployed for a customer. Normally I push these agent-type installs using group policy which is fine in most cases.\nWhile there are probably better deployment methods outside of what ConnectWise recommends I figured I\u0026rsquo;d put together a down and dirty script to speed things up for this particular install.\nFor this particular install the customer has an Active Directory domain so I will be enumerating computer objects from AD and then using PSRemoting to execute commands on the client computers.\nSimply edit the AD query on line 2 to suit the needs of your environment and populate the CW Agent download link on line 8.\nDisclaimer: Use this code at your own risk.\nImport-Module ActiveDirectory $computers = get-adcomputer ` -Filter \u0026#39;operatingsystem -notlike \u0026#34;*server*\u0026#34; -and enabled -eq \u0026#34;true\u0026#34;\u0026#39; ` -SearchBase \u0026#34;CN=Computers,DC=domain,DC=tld\u0026#34; | Select-Object -Expand DNSHostName foreach ( $computer in $computers ) { $session = New-PSSession -ComputerName $computer -ErrorAction SilentlyContinue Invoke-Command -Session $session -ErrorAction SilentlyContinue -ScriptBlock { [String]$downloadlink = \u0026#39;\u0026lt;enter your agent install dl url\u0026gt;\u0026#39; [string]$OutFile = \u0026#39;Agent_Install.exe\u0026#39; [string]$instargs = \u0026#39;/s\u0026#39; $OutPath = $env:TMP If (Test-Path c:\\windows\\ltsvc\\ltsvc.exe) { Write-Output \u0026#34;CW Agent already installed on $env:computername\u0026#34;\t} Else { Invoke-WebRequest -Uri $downloadlink -OutFile $OutPath\\$OutFile -ErrorAction SilentlyContinue Start-Process -NoNewWindow -FilePath $OutPath\\$OutFile -ArgumentList $instargs -Wait -ErrorAction SilentlyContinue Write-Output \u0026#34;CW Agent has been installed on $env:computername\u0026#34; } } Remove-PSSession $session -ErrorAction SilentlyContinue } After writing this script I got curios to see what others have been doing and found the links below to interesting scripts.\n The Lazy Administrator LabTech Consulting GitHub  ","permalink":"https://blog.kmil.us/posts/connectwise-agent-install-script/","summary":"One would think working in IT would make me a patient person. Today I found myself tired of waiting for the ConnectWise Automate agents to be deployed for a customer. Normally I push these agent-type installs using group policy which is fine in most cases.\nWhile there are probably better deployment methods outside of what ConnectWise recommends I figured I\u0026rsquo;d put together a down and dirty script to speed things up for this particular install.","title":"ConnectWise Agent Install Script"}]